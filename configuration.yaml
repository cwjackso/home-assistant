
homeassistant:
  # Name of the location where Home Assistant is running
  name: Home
  # Location required to calculate the time the sun rises and sets
  latitude: !secret latitude
  longitude: !secret longitude
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: 103
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/London
  # Customization file
  customize: !include customize.yaml
  auth_providers:
    - type: homeassistant
    - type: legacy_api_password
      api_password: !secret http_password

#whitelist the camera snapshot folder
  allowlist_external_dirs:
    - /shared/files
    
mobile_app:

system_health:

recorder:
  auto_purge: true
  purge_keep_days: 14

stream:

weather:
  - platform: darksky
    api_key: !secret dark_sky

duckdns:
  domain: !secret duck_dns_domain
  access_token: !secret duck_dns_token
  
lovelace:
  mode: yaml

alarm_control_panel:
  - platform: manual
    name: House Alarm
    code: !secret alarm_pin
    arming_time: 30
    delay_time: 20
    trigger_time: 4
    disarmed:
      trigger_time: 0
    armed_home:
      arming_time: 0
      delay_time: 0

# Enables the frontend
frontend:
  #javascript_version: latest
  themes: !include_dir_merge_named themes
  
#enable MQTT
mqtt:
  broker: !secret mqtt_broker
  port: !secret mqtt_port
  username: !secret mqtt_username
  password: !secret mqtt_password

# Enables configuration UI
config:

http:
  # Secrets are defined in the file secrets.yaml
  use_x_forwarded_for: true
  trusted_proxies: 127.0.0.1
  #base_url: !secret base_url

# nmap device tracking
device_tracker:
  - platform: nmap_tracker
    hosts: 192.168.86.140-146
    track_new_devices: yes
    consider_home: 0:35

# Discover some devices automatically
discovery:
  ignore:
    - songpal
# Enables support for tracking state changes over time
history:

# View all events in a logbook
logbook:

# Track the sun
sun:


# Text to speech
tts:
  - platform: google_translate
    service_name: google_say
  - platform: microsoft
    api_key: !secret ms_speech_api
    language: en-gb
    gender: Female
    type: HazelRUS
    rate: 15
    
#ffmpeg
ffmpeg:
  ffmpeg_bin: /usr/bin/ffmpeg

# nest
nest:
  client_id: !secret nest
  client_secret: !secret nest_secret


#tensorflow
image_processing:
  - platform: tensorflow
    scan_interval: 10000
    file_out:
      - "/shared/files/garden_camera/tensor/{{ camera_entity.split('.')[1] }}.jpg"
    source:
      - entity_id: camera.garden
    model:
      # coco
      graph: /config/tensorflow/models/efficientdet_d0_coco17_tpu-32
      
  - platform: tensorflow
    scan_interval: 10000
    file_out:
      - "/shared/files/front_door_camera/tensor/{{ camera_entity.split('.')[1] }}.jpg"
    source:
      - entity_id: camera.front_door
    model:
      # coco
      graph: /config/tensorflow/models/efficientdet_d0_coco17_tpu-32

camera:
  - platform: mjpeg
    name: "Garden"
    mjpeg_url: !secret garden_cam_stream
    
  - platform: mjpeg
    name: "Front door"
    mjpeg_url: !secret front_door_cam_stream

  - platform: generic
    name: "Garden stream"
    still_image_url: !secret garden_cam_stream
    stream_source: !secret garden_cam_rtsp

  - platform: generic
    name: "Front door stream"
    still_image_url: !secret garden_cam_stream
    stream_source: !secret front_door_cam_rtsp

light:
  - platform: mqtt
    name: "Mouse lamp"
    state_topic: "stat/sonoff/POWER"
    command_topic: "cmnd/sonoff/POWER"
    qos: 1
    payload_on: "ON"
    payload_off: "OFF"
    retain: true

notify:
  - platform: html5
    name: home_assistant
    vapid_pub_key: !secret vapid_pub_key
    vapid_prv_key: !secret vapid_prv_key
    vapid_email: !secret vapid_email

  - name: pushover
    platform: pushover
    api_key: !secret pushover_api_key
    user_key: !secret pushover_user_secret

panel_iframe:
  configurator:
    title: Configurator
    icon: mdi:wrench
    url: !secret home_assistant_url

person:
  - name: Carl
    id: carl
    user_id: 2d487ff07eae4d54b535e7d123724a0e
    device_trackers:
      - device_tracker.carl_phone
  - name: Becs
    id: becs
    user_id: 5105e1c86d0f46479e51a82d843dc9f5
    device_trackers:
      - device_tracker.bec_phone
  - name: Ollie
    id: ollie
    device_trackers:
      - device_tracker.ollie_phone

media_player: !include media_players.yaml
sensor: !include sensors.yaml
group: !include groups.yaml
automation: !include_dir_merge_list automation/
script: !include scripts/script_base.yaml
scene: !include scenes.yaml
shell_command: !include shell_commands.yaml
input_boolean: !include inputs/input_boolean.yaml
google_assistant: !include google_assistant.yaml
